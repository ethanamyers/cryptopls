Notes:

Yes, I know I program in C++ like a bad embedded C programmer...that's because I am one